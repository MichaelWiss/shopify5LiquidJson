<section class="newsletter-section">
  <div class="newsletter-container">
    {% if section.settings.heading != blank %}
      <h2 class="newsletter-heading">{{ section.settings.heading }}</h2>
    {% endif %}

    {% if section.settings.text != blank %}
      <p class="newsletter-text">{{ section.settings.text }}</p>
    {% endif %}

    {% form 'customer', class: 'newsletter-form' %}
      {% if form.posted_successfully? %}
        <p class="newsletter-feedback newsletter-feedback--success">{{ section.settings.success_message }}</p>
      {% else %}
        {% if form.errors %}
          <p class="newsletter-feedback newsletter-feedback--error">{{ form.errors | default_errors }}</p>
        {% endif %}

        <input type="hidden" name="contact[tags]" value="newsletter">

        <label class="newsletter-label" for="newsletter-email-{{ section.id }}">
          <span class="visually-hidden">{{ 'newsletter.label' | t }}</span>
        </label>
        <input
          id="newsletter-email-{{ section.id }}"
          class="newsletter-input"
          type="email"
          name="contact[email]"
          value="{{ form.email }}"
          placeholder="{{ section.settings.placeholder }}"
          required
        >
        <button class="newsletter-submit" type="submit">
          {{ section.settings.button_label }}
        </button>
      {% endif %}
    {% endform %}
  </div>
</section>

{% schema %}
{
  "name": "Newsletter",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Stay in the loop"
    },
    {
      "type": "textarea",
      "id": "text",
      "label": "Supporting text",
      "default": "Notes from the studio, launch announcements, and materials research. No noise."
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Email placeholder",
      "default": "Email address"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Subscribe"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success message",
      "default": "Thanks for subscribing."
    }
  ],
  "presets": [
    {
      "name": "Newsletter"
    }
  ]
}
{% endschema %}
