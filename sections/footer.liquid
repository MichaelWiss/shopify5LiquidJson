<footer class="site-footer">
  <div class="footer-grid">
    {% for block in section.blocks %}
      <div class="footer-column" {{ block.shopify_attributes }}>
        {% if block.settings.heading != blank %}
          <h3>{{ block.settings.heading }}</h3>
        {% endif %}

        {% case block.type %}
          {% when 'menu' %}
            {% liquid
              assign menu_handle = block.settings.menu
              assign menu_obj = nil
              if menu_handle != blank and linklists[menu_handle]
                assign menu_obj = linklists[menu_handle]
              endif
            %}
            {% if menu_obj %}
              <nav class="footer-links" aria-label="{{ block.settings.heading | default: 'Footer menu' }}">
                {% for link in menu_obj.links %}
                  <a href="{{ link.url }}">{{ link.title }}</a>
                {% endfor %}
              </nav>
            {% elsif block.settings.fallback_links != blank %}
              {% assign lines = block.settings.fallback_links | split: '\n' %}
              <nav class="footer-links" aria-label="{{ block.settings.heading | default: 'Footer menu' }}">
                {% for line in lines %}
                  {% assign parts = line | strip | split: '|' %}
                  {% if parts[0] != blank %}
                    <a href="{{ parts[1] | default: '#' }}">{{ parts[0] }}</a>
                  {% endif %}
                {% endfor %}
              </nav>
            {% endif %}
          {% when 'text' %}
            {% if block.settings.body != blank %}
              <div class="footer-links footer-text">
                {{ block.settings.body | newline_to_br }}
              </div>
            {% endif %}
        {% endcase %}
      </div>
    {% endfor %}
  </div>

{% capture default_credits %}© {{ 'now' | date: '%Y' }} {{ shop.name }}. All rights reserved.{% endcapture %}
{% assign default_setting = "© 2024 Refinements. All rights reserved." %}
{% assign credits_setting = section.settings.credits | default: '' | strip %}
{% if credits_setting == blank or credits_setting == default_setting %}
  {% assign credits_content = default_credits %}
{% else %}
  {% assign credits_content = credits_setting %}
{% endif %}

  <div class="footer-bottom">
    <div>{{ credits_content }}</div>
    {% if section.settings.privacy_link != blank or section.settings.terms_link != blank %}
      <div>
        {% if section.settings.privacy_link != blank %}
          <a href="{{ section.settings.privacy_link }}">Privacy Policy</a>
        {% endif %}
        {% if section.settings.terms_link != blank %}
          <a href="{{ section.settings.terms_link }}">Terms of Service</a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</footer>
{% schema %}
{
  "name": "Footer",
  "settings": [
    {
      "type": "textarea",
      "id": "credits",
      "label": "Credits / legal copy",
      "default": "© 2024 Refinements. All rights reserved.",
      "info": "Leave as-is or update copy; theme will override with © YEAR SHOP NAME if unchanged."
    },
    {
      "type": "url",
      "id": "privacy_link",
      "label": "Privacy policy link"
    },
    {
      "type": "url",
      "id": "terms_link",
      "label": "Terms of service link"
    }
  ],
  "blocks": [
    {
      "type": "menu",
      "name": "Menu column",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Shop"
        },
        {
          "type": "link_list",
          "id": "menu",
          "label": "Navigation menu"
        },
        {
          "type": "textarea",
          "id": "fallback_links",
          "label": "Fallback links",
          "default": "Lighting|/collections/lighting\nSeating|/collections/seating\nTables|/collections/tables\nAccessories|/collections/accessories",
          "info": "One per line in the format Label|URL. Used when no navigation menu is assigned."
        }
      ]
    },
    {
      "type": "text",
      "name": "Text column",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Studio"
        },
        {
          "type": "textarea",
          "id": "body",
          "label": "Body copy",
          "default": "Flagship — Brooklyn, NY\nConsultations by appointment."
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Footer",
      "blocks": [
        { "type": "menu" },
        { "type": "menu" },
        { "type": "text" }
      ]
    }
  ]
}
{% endschema %}
